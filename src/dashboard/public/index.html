<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Day Trade Dashboard</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <header>
    <h1>üìà Day Trade Dashboard</h1>
    <div id="status-bar">
      <span id="last-updated">Loading...</span>
      <span id="auto-refresh">üîÑ Auto-refresh: 30s</span>
    </div>
  </header>

  <main>
    <!-- Summary Cards -->
    <section class="cards">
      <div class="card" id="card-positions">
        <h3>Open Positions</h3>
        <div class="card-value" id="val-positions">‚Äî</div>
      </div>
      <div class="card" id="card-pnl">
        <h3>Today P&amp;L</h3>
        <div class="card-value" id="val-pnl">‚Äî</div>
      </div>
      <div class="card" id="card-signals">
        <h3>Signals Today</h3>
        <div class="card-value" id="val-signals">‚Äî</div>
      </div>
      <div class="card" id="card-grade">
        <h3>Last Grade</h3>
        <div class="card-value" id="val-grade">‚Äî</div>
      </div>
      <div class="card" id="card-agents">
        <h3>Live Agents</h3>
        <div class="card-value" id="val-agents">‚Äî</div>
      </div>
    </section>

    <!-- Tab navigation -->
    <nav class="tabs">
      <button class="tab active" data-tab="positions">Positions</button>
      <button class="tab" data-tab="signals">Signals</button>
      <button class="tab" data-tab="decisions">Decisions</button>
      <button class="tab" data-tab="evaluations">Evaluations</button>
      <button class="tab" data-tab="orders">Orders</button>
      <button class="tab" data-tab="agents">Agent Team</button>
      <button class="tab" data-tab="scheduler">Scheduler</button>
      <button class="tab" data-tab="database">Database</button>
    </nav>

    <!-- Tab content -->
    <section id="tab-positions" class="tab-content active">
      <div class="positions-toolbar">
        <button class="btn-close-all" id="btn-closeall-all" onclick="closePositions()">üî¥ Close All</button>
      </div>
      <table id="tbl-positions">
        <thead>
          <tr>
            <th>Symbol</th><th>Side</th><th>Strike</th><th>Expiry</th>
            <th>Qty</th><th>Entry</th><th>Stop</th><th>TP</th>
            <th>Conv</th><th>Tier</th><th>Direction</th><th>Decision</th>
            <th>Confirms</th><th>Opened</th><th>Reasoning</th><th>Action</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section id="tab-signals" class="tab-content">
      <table id="tbl-signals">
        <thead>
          <tr>
            <th>Time</th><th>Ticker</th><th>Profile</th><th>Direction</th>
            <th>Alignment</th><th>Confidence</th><th>Thresh?</th><th>Trigger</th>
            <th>Side</th><th>Symbol</th><th>Entry</th><th>Stop</th><th>TP</th>
            <th>R:R</th><th>Spread%</th><th>Liq?</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="pagination-signals"></div>
    </section>

    <section id="tab-decisions" class="tab-content">
      <table id="tbl-decisions">
        <thead>
          <tr>
            <th>Time</th><th>Ticker</th><th>Profile</th><th>Direction</th>
            <th>Decision</th><th>Confirms</th><th>Confidence</th>
            <th>Urgency</th><th>Execute</th><th>Reasoning</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="pagination-decisions"></div>
    </section>

    <section id="tab-evaluations" class="tab-content">
      <table id="tbl-evaluations">
        <thead>
          <tr>
            <th>Date</th><th>Ticker</th><th>Symbol</th><th>Grade</th>
            <th>Score</th><th>Outcome</th><th>P&amp;L</th><th>P&amp;L%</th>
            <th>Entry</th><th>Exit</th><th>Duration</th>
            <th>Signal Q</th><th>Timing Q</th><th>Risk Q</th><th>Lessons</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="pagination-evaluations"></div>
    </section>

    <section id="tab-orders" class="tab-content">
      <table id="tbl-orders">
        <thead>
          <tr>
            <th>Time</th><th>Ticker</th><th>Symbol</th><th>Side</th><th>Type</th>
            <th>Qty</th><th>Filled</th><th>Price</th><th>Fill</th>
            <th>Status</th><th>Fill Time</th><th>Error</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="pagination-orders"></div>
    </section>

    <section id="tab-agents" class="tab-content">
      <div id="agent-cards" class="agent-cards"></div>
    </section>

    <section id="tab-scheduler" class="tab-content">
      <table id="tbl-scheduler">
        <thead>
          <tr>
            <th>Run At</th><th>Trigger</th><th>Status</th><th>Skipped Reason</th>
            <th>Tickers</th><th>Results</th><th>Duration</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="pagination-scheduler"></div>
    </section>
    <section id="tab-database" class="tab-content">
      <div class="db-cleanup-panel">
        <h2 class="db-panel-title">Database Cleanup</h2>

        <div class="db-cleanup-card">
          <div class="db-cleanup-info">
            <h3>Cleanup Signal History</h3>
            <p>Deletes rows <strong>older than today</strong> from: signal_snapshots, trading_decisions, decision_confirmations, trading_sessions (CLOSED), scheduler_runs, order_agent_ticks.</p>
            <p class="db-safe-note">‚úÖ Position journal and trade evaluations are <strong>not</strong> affected.</p>
          </div>
          <button class="btn-cleanup-signals" id="btn-cleanup-signals" onclick="cleanupDb('signals')">üóëÔ∏è Cleanup Signals</button>
        </div>

        <div class="db-cleanup-card db-cleanup-danger">
          <div class="db-cleanup-info">
            <h3>Full Database Reset</h3>
            <p>Truncates <strong>all 11 tables</strong> in the trading schema ‚Äî signal_snapshots, trading_decisions, position_journal, order_executions, trade_evaluations, and more.</p>
            <p class="db-danger-note">‚ö†Ô∏è All history is permanently deleted. This cannot be undone.</p>
          </div>
          <button class="btn-cleanup-all" id="btn-cleanup-all" onclick="cleanupDb('all')">üí£ Full Reset</button>
        </div>

        <div id="db-cleanup-result" class="db-cleanup-result" style="display:none"></div>
      </div>
    </section>
  </main>

  <script src="/app.js"></script>
</body>
</html>
